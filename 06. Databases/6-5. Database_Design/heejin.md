# 6-5. 데이터베이스 설계

## ✅ ER 다이어그램 (Entity Relationship Diagram)

### 엔터티(Entity) 식별
- 시스템에서 관리해야 할 주요 개체를 찾습니다.  
- 예: `Users`, `Orders`, `Products`, `Posts`, `Reviews` 등

### 엔터티 간 관계(Relationship) 파악
- 각 엔터티 간의 연결 방식을 1:1, 1:N, N:M 관계 등으로 표현합니다.  
- 예: 한 `User`가 여러 `Order`를 가질 수 있으므로 `User : Order = 1:N`

### 속성(Attribute) 정의
- 엔터티가 가지는 세부 속성(칼럼)을 정리합니다.  
- 예: `Users` 엔터티에는 `user_id`, `name`, `email` 등이 포함됨

### ERD 작성
- 엔터티, 관계, 속성을 다이어그램으로 시각화하여 전체 구조를 한눈에 파악할 수 있도록 합니다.

---

## ✅ 스키마 설계

### 논리적 설계 (Logical Schema)
- ER 다이어그램을 기반으로 실제 테이블 구조를 정의합니다.  
- 각 엔터티를 테이블로 변환하고, 속성은 테이블의 칼럼으로 매핑합니다.  
- 엔터티 간 관계를 반영하여 외래 키(FK)를 설정합니다.

### 물리적 설계 (Physical Schema)
- 실제 RDBMS에서 테이블을 생성하기 위한 구체적인 자료형(예: `INT`, `VARCHAR`)과 인덱스 등을 결정합니다.  
- 성능 최적화를 위해 인덱스, 파티션 등의 물리적 구조를 고려합니다.

---

## ✅ 정규화 (Normalization)
데이터의 중복과 **이상 현상(Anomaly)**을 최소화하기 위해 테이블을 구조화하는 과정입니다.

### 1차 정규화 (1NF)
- **반복 속성(중첩 구조)**을 제거하고, 모든 속성이 **원자값(Atomic Value)**만 갖도록 테이블을 분해합니다.
- 예: 주소를 `도로명`과 `상세주소`로 분리, 전화번호 여러 개를 별도 테이블로 분리

### 2차 정규화 (2NF)
- **부분 함수 종속**을 제거합니다.
- 복합 키(Composite Key)를 사용하는 경우, 기본 키의 일부에만 종속된 속성을 분리해 새로운 테이블로 옮깁니다.

### 3차 정규화 (3NF)
- **이행적 종속(Transitive Dependency)**을 제거합니다.
- 기본 키가 아닌 다른 속성에 의존하는 속성을 분리하여 독립된 테이블로 구성합니다.

### 3.4 보이스/코드 정규형 (BCNF)
- 결정자가 항상 후보 키(Candidate Key)인 경우를 만족하도록 설계합니다.
- 대부분 3차 정규화까지 진행한 후 필요 시 BCNF를 검토합니다.

---

## ✅ 보안 및 ACID 고려

### 트랜잭션 설계 (ACID 원칙)
- **원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability)**을 보장할 수 있도록 트랜잭션 단위 설정 및 롤백/커밋 전략을 수립합니다.

### 보안
- 민감한 데이터 암호화
- 접근 권한 분리 및 DB 계정/권한 관리
- 안전한 데이터베이스 환경 구성

---

## ✅ 설계 예시 요약

### ERD → 스키마 변환
- **엔터티를 테이블로 정의:** 예) `User`, `Order`, `Product` 등
- **엔터티 간 관계:** FK를 통해 관계를 명시 (예: `Order` 테이블에 `user_id` 외래 키 추가)
- **속성 정의:** 칼럼의 자료형, 제약 조건 등을 명시

### 정규화 진행
- **1NF:** 테이블을 원자값으로 분할
- **2NF:** 부분 종속 제거
- **3NF:** 이행 종속 제거
- **필요 시 BCNF:** 추가 검토

### 결과
- 중복 및 이상 현상 최소화
- 엔터티 간 관계 명확화
- 확장성 및 유지보수성 향상
