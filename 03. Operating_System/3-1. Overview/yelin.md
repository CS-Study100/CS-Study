# 3. 운영체제

## 3-1. 운영체제의 큰 그림
커널: 운영체제의 핵심 기능을 담당하는 부분

운영체제의 핵심기능:  
**<ins> 1. 자원 할당 및 관리 </ins>**  
2. 프로세스 및 스레드 관리

### 💻 자원 할당 및 관리

: 사용자가 실행하는 응용 프로그램에게 자원을 효율적인 방식으로 할당 + CPU, 메모리, 보조기억장치를 효율적으로 관리</br>
>
> cf.) 자원(시스템 자원)</br>
  : 프로그램 실행에 필요한 요소(데이터-소프트웨어 / 부품-하드웨어)

- 자원 할당
- 자원 관리
  - CPU 관리: CPU 스케줄링
    > 한정된 자원인 CPU를 모든 프로그램들이 공정하게 할당받을 수 있도록 `할당 순서`와 `사용 시간`을 스케줄링
  - 메모리 관리: 가상 메모리
    > `1)새롭게 실행되는 프로그램을 메모리에 적재`, `2)종료된 프로그램은 메모리에서 삭제`, `3)낭비되는 메모리 용량이 없도록 효율적으로 메모리 관리` 를 위해 → **_가상 메모리_** 기술 활용
  - 파일/디렉터리 관리: 파일 시스템
    > 메모리보다 더 큰 용량을 갖는 `보조기억장치`는 접근이 용이하게끔 `일목요연하게 관리되어야` 함<br/>
    > → 파일/폴더(디렉토리) 단위로 접근/관리할 수 있도록 만든 운영체제 내부 프로그램인 **_파일 시스템_** 활용

  - 프로세스 및 스레드 관리
    > `프로세스`: 실행 중인 프로그램<br/>
    > `스레드`: 프로세스를 이루는 실행의 단위 (프로세스 > 스레드)<br/>
    > 운영체제가 프로세스에 자원 할당, 스레드는 프로세스가 할당받은 자원을 이용해 프로세스의 작업 수행<br/>
    > 즉, 자원의 이동 경로 : 운영체제 → 프로세스 → 스레드
    >
    > 프로세스를 이루는 스레드가 둘 이상인 경우, 동일학 작업을 동시에 실행 가능<br/>
    > 때문에 동시다발적으로 실행되는 프로세스와 스레드가 올바르게 처리되도록 `실행 순서 제어`, 이들이 요구하는 `자원을 적절히 배분`
    

---

### 💻 시스템 콜과 이중 모드
운영체제도 일종의 프로그램이기 때문에 반드시 메모리에 적재되어야 함<br/>
하지만, 사용자 프로그램과는 달리 운영체제는 매우 특별한 프로그램이므로 메모리 내의 `커널 영역`에 적재되어 실행<br/>

cf.) 사용자 응용 프로그램이 적재되는 공간: `사용자 영역`

> 때문에 `운영체제의 기능`을 제공받기 위해서는 `커널 영역`에 적재된 운영체제 코드를 실행해야 한다.‼️

일반적인 (사용자)응용 프로그램을 운영체제와 달리 CPU, 메모리와 같은 자원에 직접 접근/조작 불가<br/>
그러기 위해서는 운영체제 코드를 실행해야 함<br/>

🧐HOW? → **시스템 콜!**<br/>
> 시스템 콜: 운영체제의 서비스를 제공해주는 함수<br/>
> 응용 프로그램은 필요한 기능에 해당하는 시스템 콜을 호출함으로써 자원을 접근/조작

#### 시스템 콜 호출시, 일어나는 과정
![JPEG 이미지-425E-A86F-FF-0](https://github.com/user-attachments/assets/a39a50f6-7681-45b9-ae15-385b33c75d11)
1) 사용자 영역에서 인터럽트(ex. 시스템 콜) 발생시, CPU는 현재 수행 중인 작업을 백업하고
2) 커널 영역 내의 인터럽트를 처리하기 위한 코드(시스템 콜 구성하는 코드)를 실행한 뒤
3) 다시 사용자 영역 코드 실행을 재개

#### 이중 모드
1),3)에서 볼 수 있듯이 CPU는 명령어를 실행하는 과정에서 `사용자 영역`, `커널 영역`을 실행할 때의 `모드를 구분`하여 실행<br/>
이렇게 2개의 모드로 구분하여 실행하는 것 → 이중 모드
> 사용자 영역에 적재된 코드를 실행할 때의 모드 → 사용자 모드<br/>
> 커널 영역에 적재된 코드를 실행할 때의 모드 → 커널 모드<br/>
> cf.) 어떤 모드로 실행 중인지는 플래그 레지스터 속 슈퍼바이저 플래그를 통해 알 수 있다.

📌 이중 모드의 이점<br/>
사용자 모드로 실행 중인 CPU는 자원에 접근하는 명령어(ex. 입출력 명령어)를 만나도 이를 실행하지 않는다.<br/>
덕분에 사용자 모드로 실행되는 명령어는 실수로라도 자원에 접근할 수 없다




