## 3-3. 동기화와 교착 상태

- 공유 자원(shared resource): 프로세스 혹은 스레드가 공유하는 자원
- 임계 구역(critical section): 공유 자원에 접근하는 코드 중 동시에 실행했을 때 문제가 발생할 수 있는 코드

- 프로세스와 스레드의 동기화(synchronization)
  - 실행 순서 제어: 프로세스 및 스레드를 올바른 순서로 실행하기
  - 상호 배제: 동시에 접근해서는 안 되는 자원에 하나의 프로세스 및 스레드만 접근하기

### 1️⃣ 동기화 기법

- 뮤텍스 락(mutex lock): 동시에 접근해서는 안 되는 자원에 동시 접근이 불가능하도록 상호 배제를 보장하는 동기화 도구
- 임계 구역에 접근하고자 한다면 반드시 락을 획득, 임계 구역에서의 작업이 끝났다면 락을 해체

- 공유하는 변수와 2개의 함수 필요

```javascript
lock.acquire();
// 임계 구역
lock.release();
```

- 세마포(semaphore): 공유 자원이 여러 개 있는 상황에서 동기화가 가능한 도구
- 변수 S: 사용 가능한 공유 자원의 개수를 나타내는 변수
- wait() 함수: 임계 구역 진입 전 호출하는 함수
- signal() 함수: 임계 구역 진입 후 호출하는 함수

```javascript
wait();
// 임계 구역
signal();
```

- S < 0: 사용 가능한 공유 자원의 개수가 남아 있지 않았음

### 2️⃣ 조건 변수와 모니터

- 조건 변수(condition variable): 실행 순서 제어를 위한 동기화 도구, 특정 조건 하에 프로세스를 실행/일시 중단함으로써 프로세스나 스레드의 실행 순서를 제어
- wait() 함수: 호출한 프로세스 및 스레드의 상태를 대기 상태로 전환하는 함수
- signal() 함수: wait()로 일시 중지된 프로세스 및 스레드의 실행을 재개하는 함수

- 모니터(monitor): 공유 자원과 그 공유 자원을 다루는 함수로 구성된 동기화 도구, 상호 배제 동기화 + 실행 순서 제어 동기화까지 가능

### 3️⃣ 스레드 안전

- 스레드 안전(thread safety): 멀티스레드 환경에서 어떤 변수나 함수, 객체에 동시 접근이 이루어져도 실행에 문제가 없는 상태

### 4️⃣ 교착 상태

- 교착 상태(deadlock): 일어나지 않을 사건을 기다리며 프로세스의 진행이 멈춰 버리는 현상

- 교착 상태의 발생 조건
  - 상호 배제
  - 점유와 대기
  - 비선점
  - 원형 대기

### 5️⃣ 교착 상태의 해결 방법

1. 예방: 교착 상태를 발생시키는 4가지 필요 조건 중 하나를 충족하지 못하게 하는 것
2. 회피: 교착 상태가 발생하지 않을 정도로만 조심하면서 자원을 할당하는 것
3. 회복: 교착 상태가 검출되면 프로세스를 자원 선점을 통해 회복시키거나 교착 상태의 프로세스를 강제 종료함으로써 회복시키는 것
